openapi: 3.0.0
info:
  title: Music Bands Service
  version: 1.0.0
  description: A sample API for interaction with a collection of music bands
servers:
  - url: 'https://localhost:8080/api/v1/grammy'

paths:
  /band/{band-id}/singles/add:
    post:
      summary: Добавление нового сингла группе
      tags: 
        - Bands updates
      operationId: addSingle
      parameters:
        - name: band-id
          description: Идентификатор группы
          in: path
          required: true
          schema:
            type: string
            minLength: 1
            maxLength: 10
      responses:
        '200':
          description: Успешно добавлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Band'
        '400':
            description: Ошибка. Неправильные параметры
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    code:
                      type: integer
                      format: int32
                      example: 400
                    message:
                      type: string
                      example: Неправильные параметры
        default:
          description: Дефолтная ошибка
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DefaultError'v


  /band/{band-id}/participants/add:
    post:
      summary: Добавление участника в группу
      tags: 
        - Bands updates
      operationId: addParticipant
      parameters:
        - name: band-id
          description: Идентификатор группы
          in: path
          required: true
          schema:
            $ref: '#/components/schemas/Person'
      responses:
        '200':
          description: Успешно добавлено
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Person'
        '400':
            description: Ошибка. Неправильные параметры
            content:
              application/json:
                schema:
                  type: object
                  properties:
                    code:
                      type: integer
                      format: int32
                      example: 400
                    message:
                      type: string
                      example: Неправильные параметры
        default:
          description: Дефолтная ошибка
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DefaultError'

components:
  schemas:
    Band:
      type: object
      properties:
        id:
          type: integer
          minimum: 1
          uniqueItems: true
          readOnly: true
        name:
          type: string
          minLength: 1
        coordinates:
          $ref: '#/components/schemas/Coordinates'
        creationDate:
          type: string
          format: date-time
          readOnly: true
          default: "${now}"
        numberOfParticipants:
          type: number
          format: int64
          minimum: 1
        description:
          type: string
        genre:
          $ref: '#/components/schemas/MusicGenre'
        frontMan:
          $ref: '#/components/schemas/Person'
        singles:
          type: array
          items:
            $ref: '#/components/schemas/Single'
      required:
        - id
        - name
        - coordinates
        - creationDate
        - numberOfParticipants
        - description
        - genre
          
    Person:
      type: object
      properties:
        name:
          type: string
          minLength: 1
        birthday:
          type: string
          format: date
          nullable: true
        passportID:
          type: string
          uniqueItems: true
        location:
          $ref: '#/components/schemas/Location'
        groupID:
          type: integer
      required:
        - id
        - location
        - groupID

    Single:
      type: object
      properties:
        name:
          type: string
          minLength: 1
          maxLength: 10

    Coordinates:
      type: object
      properties:
        x:
          type: number
          format: int64
        y:
          type: number
          format: double
          minimum: -439
          nullable: false
      required:
        - x
        - y
        
    Location:
      type: object
      properties:
        x:
          type: number
          format: float
          nullable: false
        y:
          type: number
          format: float
        z:
          type: integer
        name:
          type: string
          minLength: 1
          nullable: true
      required:
        - x
        - y
        - z
        
    MusicGenre:
      type: string
      enum:
        - ROCK
        - SOUL
        - MATH_ROCK
        - POST_ROCK

    DefaultError:
      type: object
      properties:
        code:
          type: integer
          format: int32
          example: 404
        message:
          type: string
          example: Ресурс не найден